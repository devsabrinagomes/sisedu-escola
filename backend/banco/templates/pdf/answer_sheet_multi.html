{% load static %}
<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Cartão Resposta</title>

  <style>
    @page { size: A4; margin: 12mm; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: Arial, Helvetica, sans-serif; color:#111; font-size: 8.6pt; background:#fff; }

    :root{
      --ink:#0f172a;
      --dark-green:#1f5f3a;
    }

    .sheet{ display:grid; gap: 8mm; min-height: 273mm; align-content: stretch; }
    .sheet.cards-4{ grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; }
    .sheet.cards-3{ grid-template-columns: 1fr; grid-template-rows: 1fr 1fr 1fr; }
    .sheet.cards-2{ grid-template-columns: 1fr; grid-template-rows: 1fr 1fr; }
    .sheet.cards-1{ grid-template-columns: 1fr; grid-template-rows: 1fr; }

    .card{
      border: 1.4px solid #111;
      border-radius: 2.5mm;
      padding: 4mm;
      page-break-inside: avoid;
      overflow: visible;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }

    .card.scale-4{ font-size: 7.4pt; }
    .card.scale-3{ font-size: 7.8pt; }
    .card.scale-2{ font-size: 8.2pt; }
    .card.scale-1{ font-size: 8.6pt; }

    .card-header{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 4mm;
      padding-bottom: 2.2mm;
      border-bottom: 2px solid var(--dark-green);
      margin-bottom: 1.4mm;
    }

    .brand-left{ display:flex; flex-direction:column; gap: 0.8mm; min-width:0; margin-left: -1mm; }
    .brand-left img{ height: 14mm; width:auto; object-fit:contain; display:block; }
    .brand-sub{ margin:0; font-weight:800; color: var(--ink); }

    .brand-right img{ height: 10mm; width:auto; object-fit:contain; display:block; }

    .title{
      font-weight: 900;
      text-transform: uppercase;
      margin: 2mm 0 1.2mm 0;
      color: var(--ink);
      letter-spacing: .2px;
    }

    .row-fields{ display:flex; gap: 4mm; margin-bottom: 1.2mm; }
    .name-line{ margin-bottom: 1.2mm; }
    .line-field{ flex:1; display:flex; align-items:center; gap: 2mm; }
    .line-field span{ font-weight:800; white-space:nowrap; color:var(--ink); }
    .line{ flex:1; border-bottom: 1.4px solid #111; height:0; transform: translateY(1mm); }

    .booklet-bar{
      border: 1.4px solid var(--dark-green);
      border-radius: 2mm;
      padding: 1mm 2.4mm;
      background: #fff;
      text-align:center;
      font-weight: 900;
      margin: 1.8mm 0 1.6mm 0;
      color: var(--ink);
    }

    .grid-wrap{
      border: 0;
      border-radius: 0;
      padding: 0;
      background:#fff;
      margin-top: 1.4mm;
    }

    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap: 4mm; }
    .col{
      border: 1.4px solid #111;
      border-radius: 2mm;
      padding: 1.6mm 1.2mm;
      page-break-inside: avoid;
      overflow: hidden;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 1.6mm;
      justify-content: space-evenly;
    }

    .row{
      display:flex;
      align-items:center;
      gap: 2.2mm;
      margin: 0;
      min-height: 6.6mm;
      line-height: 1;
      page-break-inside: avoid;
      min-width: 0;
    }

    .qnum{
      width: 8.4mm;
      font-weight: 900;
      text-align: right;
      font-variant-numeric: tabular-nums;
      font-size: 7.6pt;
      color: var(--ink);
    }

    .bubbles{
      display:grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      column-gap: 1.1mm;
      width: 100%;
      min-width: 0;
    }

    .bubble{
      width: 5.2mm;
      height: 5.2mm;
      border: 1.2px solid #111;
      border-radius: 50%;
      justify-self: center;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight: 900;
      font-size: 6.5pt;
      line-height: 1;
      background:#fff;
      color:#111;
      flex: 0 0 auto;
    }

    .scale-1 .bubble{ width: 6.8mm; height: 6.8mm; font-size: 8.1pt; }
    .scale-2 .bubble{ width: 6.1mm; height: 6.1mm; font-size: 7.5pt; }
    .scale-3 .bubble{ width: 5.4mm; height: 5.4mm; font-size: 6.9pt; }
    .scale-4 .bubble{ width: 5.0mm; height: 5.0mm; font-size: 6.3pt; }
    .scale-2 .row{ min-height: 7.2mm; }
    .scale-2 .qnum{ font-size: 8.2pt; }
  </style>
</head>

<body>
  <div class="sheet cards-{{ per_sheet }}">
    {% for _ in cards %}
      <div class="card scale-{{ per_sheet }}">
        <div class="card-header">
          <div class="brand-left">
            <img src="{% static 'assets/images/logo/logo.png' %}" alt="Sisedu Escola">
            <p class="brand-sub">Avaliação • Cartão Resposta</p>
          </div>
          <div class="brand-right">
            <img src="{% static 'assets/images/logo/ceara.png' %}" alt="Ceará Governo do Estado">
          </div>
        </div>

        <div class="title">Cartão Resposta</div>

        <div class="line-field name-line"><span>Nome:</span><div class="line"></div></div>

        <div class="row-fields">
          <div class="line-field"><span>Série:</span><div class="line"></div></div>
          <div class="line-field"><span>Turma:</span><div class="line"></div></div>
          <div class="line-field"><span>Turno:</span><div class="line"></div></div>
        </div>

        <div class="booklet-bar">Caderno: {{ booklet_name }}</div>

        <div class="grid-wrap">
          <div class="grid">
            <div class="col">
              {% for n in left_nums %}
              <div class="row">
                <div class="qnum">{{ n|stringformat:"02d" }}</div>
                <div class="bubbles">
                  <div class="bubble">A</div><div class="bubble">B</div><div class="bubble">C</div><div class="bubble">D</div><div class="bubble">E</div>
                </div>
              </div>
              {% endfor %}
            </div>

            <div class="col">
              {% for n in right_nums %}
              <div class="row">
                <div class="qnum">{{ n|stringformat:"02d" }}</div>
                <div class="bubbles">
                  <div class="bubble">A</div><div class="bubble">B</div><div class="bubble">C</div><div class="bubble">D</div><div class="bubble">E</div>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</body>
</html>
